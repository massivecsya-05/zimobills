<!doctype html>
<html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="stylesheet" href="/css/styles.css"/><title>NRWB - Bills</title></head>
<body>
<header><h1>Bill Checking</h1><nav>
<a href="/index.html">Home</a>
<a href="/faults.html">Faults</a>
<a href="/bills.html">Bills</a>
<a href="/tokens.html">Tokens</a>
<a href="/complaints.html">Complaints</a>
<a href="/calculator.html">Calculator</a>
<a href="/tips.html">Tip-offs</a>
<a href="/announcements.html">Announcements</a>
</nav></header>
<main>
<form id="billForm">
<label>Account<input name="account" required placeholder="e.g. 1234567"/></label>
<button type="submit">Check Bill</button>
</form>
<div id="billResult" class="card" style="display:none"></div>
</main>
<script>
const API = localStorage.getItem('apiBase') || 'http://localhost:8000';
const form = document.getElementById('billForm');
const result = document.getElementById('billResult');
form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const account = new FormData(form).get('account');
  const res = await fetch(`${API}/bills`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ account }) });
  const data = await res.json();
  result.style.display = 'block';
  result.innerHTML = `<h3>Outstanding Balance: MWK ${data.balance.toFixed(2)}</h3>` +
    '<h4>History</h4>' +
    data.history.map(h => `<div class="row"><span>${h.date}</span><span>${h.amount.toFixed(2)}</span></div>`).join('');
});
</script>
</body></html>
